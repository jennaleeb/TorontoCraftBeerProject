vector <- df.dist[20,]
vector <- sort(vector)
vector[2:6]
scotch.dist <- dist(scotch_data[,2:69], "binary")
scotch.dist <- as.matrix(df.dist, labels=TRUE,)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
help(dist)
scotch.dist <- dist(scotch_data[,2:69], "manhattan")
scotch.dist <- as.matrix(df.dist, labels=TRUE,)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
# find the 5 most similar whiskeys to Bunnah
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
scotch.dist <- dist(scotch_data[,2:69], "euclidean")
scotch.dist <- as.matrix(df.dist, labels=TRUE,)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
# find the 5 most similar whiskeys to Bunnah
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
scotch.dist <- dist(scotch_data[,2:69], "euclidean")
scotch.dist <- as.matrix(df.dist, labels=TRUE,)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
# find the 5 most similar whiskeys to Bunnah
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
View(scotch.dist)
View(scotch.dist)
image(1:dim, 1:dim, dst, axes = FALSE, xlab="", ylab="")
dim <- ncol(scotch.dist)
image(1:dim, 1:dim, scotch.dist, axes = FALSE, xlab="", ylab="")
axis(1, 1:dim, scotch_data[,2:69], cex.axis = 0.5, las=3)
axis(1, 1:dim, scotch_data[1:20,1], cex.axis = 0.5, las=3)
axis(1, 1:dim, scotch_data[1:109,1], cex.axis = 0.5, las=3)
axis(2, 1:dim, scotch_data[1:109,1], cex.axis = 0.5, las=1)
text(expand.grid(1:dim, 1:dim), sprintf("%0.1f", dst), cex=0.6)
text(expand.grid(1:dim, 1:dim), sprintf("%0.1f", scotch.dist), cex=0.6)
install.packages("d3heatmap")
library(d3heatmap)
d3heatmap(scotch_data, scale = "column")
d3heatmap(scotch.dist, scale = "column")
d3heatmap(scotch.dist, scale = "column", dendrogram = "none", color = "Blues")
# Scotch whiskey example
library(rio)
library(dplyr)
library(knitr)
library(ggplot2)
install.packages("clusteval")
# Scotch whiskey example
library(rio)
library(dplyr)
library(knitr)
library(ggplot2)
library(clusteval)
scotch_data <- import("Scotch_XL3.0.xlsx")
head(scotch_data)
# delete first row
scotch_data <- scotch_data[-1,]
# delete first column
scotch_data <- scotch_data[,-1]
ncol(scotch_data)
# only keep tasting notes
scotch_data <- scotch_data[,1:69]
# delete last 2 rows that don't have stuff
scotch_data <- scotch_data[1:109,]
bunnah <- as.numeric(as.vector(scotch_data[20,2:69]))
ardbeg <- as.numeric(as.vector(scotch_data[3,2:69]))
glenglas <- as.numeric(as.vector(scotch_data[49,2:69]))
tulli <- as.numeric(as.vector(scotch_data[109,2:69]))
# This gives me the distance function in the book!! Closer value to 0 = more similar
dist(t(cbind(unlist(bunnah), unlist(ardbeg))), "binary")
# These do the same thing
dist(t(cbind(as.numeric(as.vector(scotch_data[20,2:69])), as.numeric(as.vector(scotch_data[3,2:69])))), "binary")
dist(t(cbind(unlist(scotch_data[20,2:69]), unlist(scotch_data[3,2:69]))), "binary")
nrow(scotch_data)
distanceMetric <- function(rowNum, data){
results <- rep(NA, nrow(data))
for (i in 1:nrow(data)) {
scotch_name <- data[i,1]
distMet <- dist(t(cbind(unlist(data[rowNum-1,2:69]), unlist(data[i,2:69]))), "binary")
results[i] <- distMet
results <- sort(results)
}
return(results)
}
test_bunnah <- distanceMetric(21, scotch_data)
apply(scotch_data, 1, distanceMetric)
scotch_data[1,1]
help(dist)
n = c(2, 3, 5)
s = c("aa", "bb", "cc")
b = c(TRUE, FALSE, TRUE)
df = data.frame(n, s, b)
name <- scotch_data[1,1]
dist <- dist(t(cbind(unlist(scotch_data[20,2:69]), unlist(scotch_data[1,2:69]))), "binary")
data.frame(name,1)
newdataframe[name, dist]
# Ok this makes the nice matrix!! (using different methods (binary/eucl..) seems to be the same)
scotch.dist <- dist(scotch_data[,2:69], "euclidean")
scotch.dist <- as.matrix(df.dist, labels=TRUE)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
# find the 5 most similar whiskeys to Bunnah
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
# Make a heat map
dim <- ncol(scotch.dist)
image(1:dim, 1:dim, scotch.dist, axes = FALSE, xlab="", ylab="")
axis(1, 1:dim, scotch_data[1:109,1], cex.axis = 0.5, las=3)
axis(2, 1:dim, scotch_data[1:109,1], cex.axis = 0.5, las=1)
text(expand.grid(1:dim, 1:dim), sprintf("%0.1f", scotch.dist), cex=0.6)
# another approach
install.packages("d3heatmap")
library(d3heatmap)
d3heatmap(scotch.dist, scale = "column", dendrogram = "none", color = "Blues")
bunnah_vec <- scotch.dist[20,]
test_bunnah <- distanceMetric(21, scotch_data)
test_bunnah
apply(scotch_data, 1, distanceMetric)
scotch_data
head(scotch_data)
head(scotch_data)
# delete first row
scotch_data <- scotch_data[-1,]
# delete first column
scotch_data <- scotch_data[,-1]
ncol(scotch_data)
# only keep tasting notes
scotch_data <- scotch_data[,1:69]
# delete last 2 rows that don't have stuff
scotch_data <- scotch_data[1:109,]
bunnah <- as.numeric(as.vector(scotch_data[20,2:69]))
ardbeg <- as.numeric(as.vector(scotch_data[3,2:69]))
glenglas <- as.numeric(as.vector(scotch_data[49,2:69]))
tulli <- as.numeric(as.vector(scotch_data[109,2:69]))
scotch_data
scotch_data <- scotch_data[-1,]
scotch_data <- scotch_data[,-1]
ncol(scotch_data)
scotch_data
ncol(scotch_data)
head(scotch_data)
scotch_data <- scotch_data[-1,]
scotch_data <- scotch_data[,-1]
scotch_data <- scotch_data[,1:69]
ncol(scotch_data)
scotch_data <- import("Scotch_XL3.0.xlsx")
ncol(scotch_data)
scotch_data <- scotch_data[-1,]
scotch_data <- scotch_data[,-1]
ncol(scotch_data)
scotch_data <- scotch_data[,1:69]
scotch_data <- scotch_data[1:109,]
bunnah <- as.numeric(as.vector(scotch_data[20,2:69]))
ardbeg <- as.numeric(as.vector(scotch_data[3,2:69]))
glenglas <- as.numeric(as.vector(scotch_data[49,2:69]))
tulli <- as.numeric(as.vector(scotch_data[109,2:69]))
dist(t(cbind(unlist(bunnah), unlist(ardbeg))), "binary")
distanceMetric <- function(rowNum, data){
results <- rep(NA, nrow(data))
for (i in 1:nrow(data)) {
scotch_name <- data[i,1]
distMet <- dist(t(cbind(unlist(data[rowNum-1,2:69]), unlist(data[i,2:69]))), "binary")
results[i] <- distMet
results <- sort(results)
}
return(results)
}
test_bunnah <- distanceMetric(21, scotch_data)
test_bunnah
apply(scotch_data, 1, distanceMetric)
scotch.dist <- dist(scotch_data[,2:69], "euclidean")
scotch.dist <- as.matrix(df.dist, labels=TRUE)
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
scotch.dist
bunnah_vec <- scotch.dist[20,]
bunnah_vec
bunnah_vec[2:6]
scotch.dist <- dist(scotch_data[,2:69], "binary")
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
install.packages("hclust")
library(hclust)
hclust(scotch.dist)
hclustfunc <- function(x, method = "complete", dmeth = "euclidean") {
hclust(dist(x, method = dmeth), method = method)
}
fit <- hclustfunc(scotch_data[,2:69])
fit
fit <- hclustfunc(scotch_data)
fit <- hclustfunc(scotch_data[,2:69])
hclustfunc <- function(x) hclust(x, method="complete")
distfunc <- function(x) as.dist((1-cor(t(x)))/2)
d <- distfunc(scotch_data[,2:69])
d <- distfunc(1)
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
d <- distfunc(scotch.dist)
fit <- hclustfunc(d)
fit
fit <- hclustfunc(scotch.dist)
fit <- hclustfunc(scotch_data[,2:69])
hclustfunc <- function(x, method = "complete", dmeth = "euclidean") {
hclust(dist(x, method = dmeth), method = method)
}
fit <- hclustfunc(scotch_data[,2:69])
fit
plot(fit)
scotch.dist <- dist(scotch_data[,2:69], "Jaccard")
install.packages("proxy")
library(proxy)
scotch.dist <- dist(scotch_data[,2:69], "Jaccard")
scotch.dist
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
scotch.dist
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
scotch.dist
scotch_data[,2:69]
view(scotch_data)
View(scotch_data)
scotch.dist <- dist(scotch_data[,2:69], "Jaccard")
scotch.dist <- dist(scotch_data[,2:69], "binary")
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
View(scotch.dist)
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
View(scotch.dist)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
scotch_data <- import("Scotch_XL3.0.xlsx")
head(scotch_data)
scotch_data <- scotch_data[-1,]
scotch_data <- scotch_data[,-1]
ncol(scotch_data)
scotch_data <- scotch_data[,1:69]
ncol(scotch_data)
scotch_data <- scotch_data[1:109,]
dist(t(cbind(unlist(bunnah), unlist(ardbeg))), "binary")
scotch.dist <- dist(scotch_data[,2:69], "binary")
View(scotch.dist)
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
View(scotch.dist)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
rownames(scotch.dist)
colnames(scotch.dist)
scotch_data[,1]
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
scotch.dist <- dist(scotch_data[,2:69], "binary")
scotch.dist
scotch_data[,2:69]
scotch_data[1,1]
head(scotch_data)
dist <- dist(t(cbind(unlist(scotch_data[20,2:69]), unlist(scotch_data[1,2:69]))), "binary")
dist
scotch.dist <- dist(scotch_data[,2:69], "binary")
scotch.dist
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
scotch.dist <- dist(scotch_data[,2:69], "euclidean")
scotch.dist
scotch.dist <- as.matrix(df.dist, labels=TRUE)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
lst <- list(numbers = 1:10, letters = letters, boolean = c(TRUE, FALSE))
lst
lst$numbers
lst[1]
lst[[1]
1
lst[[1]]
library(rio)
library(dplyr)
library(knitr)
library(ggplot2)
library(clusteval)
data <- import("BeerSurveyResponses_Test.csv")
data
beer_data <- import("BeerSurveyResponses_Test.csv")
iris
model.matrix( ~ Species - 1, data=iris )
iris
iris2 <- model.matrix( ~ Species - 1, data=iris )
iris2
head(iris2)
View(iris)
View(iris2)
irir
iris
iris_species <- model.matrix( ~ Species - 1, data=iris )
iris[,1]
iris[,6:9] <- model.matrix( ~ Species - 1, data=iris )
View(iris_species)
cbind(with(iris, model.matrix(~ Species + 0)))
help(cbind)
cbind(iris, with(iris, model.matrix(~ Species + 0)))
cbind(iris, with(iris, model.matrix(~ Species + 1)))
cbind(iris, with(iris, model.matrix(~ Species + 0)))
cbind(iris, model.matrix(~ Species + 0))
cbind(iris, model.matrix(~ Species + 0, data=iris))
beer_data
cbind(beer_data, with(beer_data, model.matrix(~ Colour + 0)), with(beer_data, model.matrix(~ Opacity + 0)))
cbind(beer_data, with(beer_data, model.matrix(~ Colour + 0)),
with(beer_data, model.matrix(~ Opacity + 0)),
with(beer_data, model.matrix(~ Taste + 0)))
beer_data %>%
cbind(., with(beer_data, model.matrix(~ Colour + 0)),
with(beer_data, model.matrix(~ Opacity + 0)),
with(beer_data, model.matrix(~ Taste + 0)))
beer_data$Taste
beer_data$Taste[1]
beer_data$Taste[2]
beer_data$Taste[3]
beer_data$Taste[4]
beer_data$Taste[5]
dd = data.frame(V1 = c("1, 2, 3", "1, 2, 4", "2, 3, 4, 5",
"1, 3, 4", "1, 3, 5", "2, 3, 4, 5"),
stringsAsFactors=FALSE)
make_row = function(i, ncol=5) {
##Could make the default NA if needed
m = numeric(ncol)
v = as.numeric(strsplit(i, ",")[[1]])
m[v] = 1
return(m)
}
t(apply(dd, 1, make_row))
dd
t(apply(dd, 1, make_row))
t(apply(beer_data$Taste,1,make_row))
max(as.numeric(unlist(strsplit(dd$V1, ", "))))
dd
unlist(strsplit(dd$V1, ", "))
unlist(strsplit(beer_data$Taste, ", "))
t(apply(beer_data, 1, unlist(strsplit(beer_data$Taste, ", "))))
split_attributes <- function() {
unlist(strsplit(beer_data$Taste, ", "))
}
t(apply(beer_data, 1, split_attributes))
split_attributes <- function() {
return(unlist(strsplit(beer_data$Taste, ", ")))
}
t(apply(beer_data, 1, split_attributes))
beer_data$Taste[1]
unlist(strsplit(beer_data$Taste[1], ", "))
install.packages("mChoice")
library(mChoice)
library(mChoice)
help(mChoice)
??mChoice
install.packages("Hmisc")
install.packages("Hmisc")
library(Hmisc)
format.mChoice(beer_data, minlength=NULL, sep=",", ...)
format.mChoice(beer_data, minlength=NULL, sep=",")
options(digits=3)
set.seed(3)
n <- 20
sex <- factor(sample(c("m","f"), n, rep=TRUE))
age <- rnorm(n, 50, 5)
treatment <- factor(sample(c("Drug","Placebo"), n, rep=TRUE))
# Generate a 3-choice variable; each of 3 variables has 5 possible levels
symp <- c('Headache','Stomach Ache','Hangnail',
'Muscle Ache','Depressed')
symptom1 <- sample(symp, n, TRUE)
symptom2 <- sample(symp, n, TRUE)
symptom3 <- sample(symp, n, TRUE)
cbind(symptom1, symptom2, symptom3)[1:5,]
Symptoms <- mChoice(symptom1, symptom2, symptom3, label='Primary Symptoms')
Symptoms
print(Symptoms, long=TRUE)
format(Symptoms[1:5])
inmChoice(Symptoms,'Headache')
levels(Symptoms)
inmChoice(Symptoms, 3)
inmChoice(Symptoms, c('Headache','Hangnail'))
head()
head()
tags$head()
library(shiny)
head()
tags$head()
tags$link("stylesheet", "text/css", "file.css")
tags$link(rel = "stylesheet", "text/css", "file.css")
tags$link(rel = "stylesheet", type = "text/css", href = "file.css")
library(rio)
scotch_data <- import("Scotch_XL3.0.xlsx")
scotch_data
scotch_data <- scotch_data[-1,]
scotch_data <- scotch_data[,-1]
ncol(scotch_data)
scotch_data <- scotch_data[,1:69]
scotch_data <- scotch_data[1:109,]
bunnah <- as.numeric(as.vector(scotch_data[20,2:69]))
bunnah
distanceMetric <- function(rowNum, data){
results <- rep(NA, nrow(data))
for (i in 1:nrow(data)) {
scotch_name <- data[i,1]
distMet <- dist(t(cbind(unlist(data[rowNum-1,2:69]), unlist(data[i,2:69]))), "binary")
results[i] <- distMet
results <- sort(results)
}
return(results)
}
test_bunnah <- distanceMetric(21, scotch_data)
test_bunnah
scotch.dist <- dist(scotch_data[,2:69], "euclidean")
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
scotch.dist
bunnah_vec <- scotch.dist[20,]
bunnah_vec
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
scotch.dist <- dist(scotch_data[,2:69], "binary")
scotch.dist
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
scotch_data <- import("Scotch_XL3.0.xlsx")
ncol(scotch_data)
scotch.dist <- dist(scotch_data[,2:69], "binary")
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
scotch_data <- import("Scotch_XL3.0.xlsx")
scotch_data <- scotch_data[-1,]
scotch_data <- scotch_data[,-1]
ncol(scotch_data)
scotch_data <- scotch_data[,1:69]
scotch_data <- scotch_data[1:109,]
scotch.dist <- dist(scotch_data[,2:69], "binary")
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
write.csv(scotch_data, "scotch_data_cleaned.csv")
scotch_data <- NULL
scotch_data <- import("scotch_data_cleaned.csv")
scotch.dist <- dist(scotch_data[,2:69], "binary")
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
View(scotch_data)
scotch_data <- NULL
View(scotch_data)
scotch_data <- import("scotch_data_cleaned.csv")
View(scotch_data)
scotch_data <- import("Scotch_XL3.0.xlsx")
head(scotch_data)
scotch_data <- scotch_data[-1,]
scotch_data <- scotch_data[,-1]
ncol(scotch_data)
scotch_data <- scotch_data[,1:69]
scotch_data <- scotch_data[1:109,]
head(scotch_data)
write.csv(scotch_data, "scotch_data_cleaned.csv")
scotch_data_2 <- import("scotch_data_cleaned.csv")
View(scotch_data_2)
scotch_data[1,]
scotch_data[,1]
scotch_data <- import("scotch_data_cleaned.csv")
scotch_data[,2:69]
ncol(scotch_data)
scotch.dist <- dist(scotch_data[,2:69], "binary")
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
scotch.dist
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
scotch.dist
scotch_data[,1]
scotch_data <- import("scotch_data_cleaned.csv")
scotch_data[,1]
scotch_data[,2]
scotch_data[,1]
scotch_data[,1] <- NULL
scotch_data[,1]
ncol(scotch_data)
scotch.dist <- dist(scotch_data[,2:69], "binary")
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
library(shiny)
library(rio)
scotch_data <- import("scotch_data_cleaned.csv")
scotch_data
scotch_data[,1] <- NULL
head(scotch_data)
scotch.dist <- dist(scotch_data[,2:69], "binary")
scotch.dist <- as.matrix(scotch.dist, labels=TRUE)
colnames(scotch.dist) <- rownames(scotch.dist) <- scotch_data[,1]
head(scotch.dist)
bunnah_vec <- scotch.dist[20,]
bunnah_vec <- sort(bunnah_vec)
bunnah_vec[2:6]
shiny::runApp('~/Desktop/programming/R/scotch-app')
